{"version":3,"sources":["webpack:///src/app/pages/game/game-form/game-form-routing.module.ts","webpack:///src/app/pages/game/game-form/game-form.module.ts","webpack:///src/app/services/photo.service.ts"],"names":["routes","path","component","GameFormPageRoutingModule","imports","forChild","exports","GameFormPageModule","declarations","Camera","Filesystem","Storage","PhotoService","request","photos","convertBlobToBase64","blob","Promise","resolve","reject","reader","FileReader","onerror","onload","result","readAsDataURL","serviceImage","url","thumb","pathDefault","photo","Photo","image","getPhoto","resultType","Uri","source","quality","capturedPhoto","readAsBase64","base64Data","unshift","webPath","data","cameraPhoto","fetch","response","isLoadPthoto","id","api_update","api_create","providedIn","filepath","webviewPath"],"mappings":"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","file":"pages-game-game-form-game-form-module-es5.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { GameFormPage } from './game-form.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: GameFormPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class GameFormPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { GameFormPageRoutingModule } from './game-form-routing.module';\n\nimport { GameFormPage } from './game-form.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    GameFormPageRoutingModule\n  ],\n  declarations: [GameFormPage]\n})\nexport class GameFormPageModule {}\n","import { Injectable } from '@angular/core';\nimport { Plugins, CameraResultType, Capacitor, FilesystemDirectory, \n  CameraPhoto, CameraSource } from '@capacitor/core';\nimport { Model } from '../api/models/model';\nimport { RequestService } from '../api/request.service';\n\nconst { Camera, Filesystem, Storage } = Plugins;\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class PhotoService {\n\n  public photos: Photo[] = [];\n\n  public photo : any;\n  public url :string ;\n  public thumb : boolean ;\n  public serviceImage : Model;\n  public image : any ;\n  public path : string;\n\n  constructor(request : RequestService) { \n      this.serviceImage = new Model('Image',request);\n  }\n\n  public init(url : string, thumb : boolean = true,pathDefault = 'assets/images/pngwing.png'){\n      this.url = url ?? '/images/';\n      this.thumb = thumb ?? false ;\n      this.path = pathDefault;\n      this.photo = new Photo(pathDefault);\n  }\n\n  setImage(image){\n    this.image = image;\n    this.photo.image = image;\n  }\n\n  public async addNewToGallery() {\n    // Take a photo\n    const capturedPhoto = await Camera.getPhoto({\n      resultType: CameraResultType.Uri, \n      source: CameraSource.Camera, \n      quality: 100 \n    });\n\n\n\n    const base64Data = await this.readAsBase64(capturedPhoto);\n\n  \n    this.photos.unshift(new Photo(null,capturedPhoto.webPath, base64Data, this.url, this.thumb));\n  }\n\n\n  public async addOneNewToGallery() {\n    // Take a photo\n    const capturedPhoto = await Camera.getPhoto({\n      resultType: CameraResultType.Uri, \n      source: CameraSource.Camera, \n      quality: 100 \n    });\n  \n    const base64Data = await this.readAsBase64(capturedPhoto);\n\n    this.photo = new Photo(capturedPhoto.webPath,base64Data, base64Data, this.url, this.thumb, this.image);\n\n  \n  }\n\n  public isLoadPthoto() {\n    return  this.photo.data? true : false;\n  }\n\n  private async readAsBase64(cameraPhoto: CameraPhoto) {\n    // Fetch the photo, read as a blob, then convert to base64 format\n    const response = await fetch(cameraPhoto.webPath!);\n    const blob = await response.blob();\n  \n    return await this.convertBlobToBase64(blob) as string;  \n  }\n  \n  convertBlobToBase64 = (blob: Blob) => new Promise((resolve, reject) => {\n    const reader = new FileReader;\n    reader.onerror = reject;\n    reader.onload = () => {\n        resolve(reader.result);\n    };\n    reader.readAsDataURL(blob);\n  });\n\n\n  uploadImage(){\n    if(this.isLoadPthoto()){\n      if(this.photo.id){\n        return this.serviceImage.api_update(this.photo);\n      }else{\n        return this.serviceImage.api_create(this.photo);\n      }\n    }\n  }\n}\n\nexport class Photo {\n  id? : string;\n  filepath: string;\n  webviewPath: string;\n  data :string;\n  url : string;\n  thumb : boolean;\n  image ? :{}\n\n  constructor(  filepath : string = \"assets/images/pngwing.png\",webviewPath : string = null,data :string = '',url : string = '',thumb : boolean = false , image : any = null){\n    this.id = image ? image.id : '';\n    this.webviewPath = webviewPath;\n    this.filepath = filepath;\n    this.data = data;\n    this.url = url;\n    this.thumb = thumb;\n    this.image = image\n  }\n\n  getPath(){\n    if(this.webviewPath){\n      return this.webviewPath;\n    }\n    else if(this.image && this.image['urlComplete'] ){\n      return this.image['urlComplete'];\n    }else{\n      return this.filepath;\n    }\n  }\n}\n"]}